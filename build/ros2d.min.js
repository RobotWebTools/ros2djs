var ROS2D=ROS2D||{REVISION:"1"};createjs.Stage.prototype.globalToRos=function(t,e){var i=t/this.scaleX,o=(this.y-e)/this.scaleY;return{x:i,y:o}},createjs.Stage.prototype.rosQuaternionToGlobalTheta=function(t){var e=t.w,i=t.x,o=t.y,r=t.z,s=Math.atan2(2*(e*r+i*o),1-2*(Math.pow(o,2)+Math.pow(r,2))),a=s*(180/Math.PI);return a>=0&&180>=a?a+=270:a-=90,-a},ROS2D.OccupancyGrid=function(t){t=t||{};var e=t.message,i=document.createElement("canvas"),o=i.getContext("2d");this.pose=new ROSLIB.Pose({position:e.info.origin.position,orientation:e.info.origin.orientation}),this.width=e.info.width,this.height=e.info.height,i.width=this.width,i.height=this.height;for(var r=o.createImageData(this.width,this.height),s=0;this.height>s;s++)for(var a=0;this.width>a;a++){var n,h=a+(this.height-s-1)*this.width,c=e.data[h];n=100===c?0:0===c?255:127;var d=4*(a+s*this.width);r.data[d]=n,r.data[++d]=n,r.data[++d]=n,r.data[++d]=255}o.putImageData(r,0,0),createjs.Bitmap.call(this,i),this.y=-this.height*e.info.resolution,this.scaleX=e.info.resolution,this.scaleY=e.info.resolution,this.width*=this.scaleX,this.height*=this.scaleY},ROS2D.OccupancyGrid.prototype.__proto__=createjs.Bitmap.prototype,ROS2D.OccupancyGridClient=function(t){var e=this;t=t||{};var i=t.ros,o=t.topic||"/map";this.continuous=t.continuous,this.rootObject=t.rootObject||new createjs.Container,this.currentGrid=null;var r=new ROSLIB.Topic({ros:i,name:o,messageType:"nav_msgs/OccupancyGrid",compression:"png"});r.subscribe(function(t){e.currentGrid&&e.rootObject.removeChild(e.currentGrid),e.currentGrid=new ROS2D.OccupancyGrid({message:t}),e.rootObject.addChild(e.currentGrid),e.emit("change"),e.continuous||r.unsubscribe()})},ROS2D.OccupancyGridClient.prototype.__proto__=EventEmitter2.prototype,ROS2D.NavigationArrow=function(t){t=t||{};var e=t.size||10,i=t.strokeSize||3,o=t.strokeColor||createjs.Graphics.getRGB(0,0,0),r=t.fillColor||createjs.Graphics.getRGB(255,0,0),s=new createjs.Graphics;s.setStrokeStyle(i),s.moveTo(-e/2,e/2),s.beginStroke(o),s.beginFill(r),s.lineTo(0,-e),s.lineTo(e/2,e/2),s.lineTo(-e/2,e/2),s.closePath(),s.endFill(),s.endStroke(),createjs.Shape.call(this,s)},ROS2D.NavigationArrow.prototype.__proto__=createjs.Shape.prototype,ROS2D.Viewer=function(t){var e=this;t=t||{};var i=t.divID;this.width=t.width,this.height=t.height;var o=t.background||"#111111",r=document.createElement("canvas");r.width=this.width,r.height=this.height,r.style.background=o,document.getElementById(i).appendChild(r),this.scene=new createjs.Stage(r),this.scene.y=this.height,document.getElementById(i).appendChild(r),createjs.Ticker.setFPS(30),createjs.Ticker.addListener(function(){e.scene.update()})},ROS2D.Viewer.prototype.addObject=function(t){this.scene.addChild(t)},ROS2D.Viewer.prototype.scaleToDimensions=function(t,e){this.scene.scaleX=this.width/t,this.scene.scaleY=this.height/e};